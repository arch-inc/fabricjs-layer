!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).layer={})}(this,(function(e){"use strict";
/*!
   * Copyright (c) 2020 Arch Inc. (Jun Kato)
   *
   * fabricjs-layer, lightweight layer management for Fabric.js
   * @license MIT
   */"undefined"==typeof fabric?require("fabric").fabric:fabric;var t=function(){function e(e){this.canvas=e,this.type="Layer",this.createdTime=Date.now(),this.startIndex=this.endIndex=e._objects.length}return e.prototype.addListener=function(e){this._listeners.indexOf(e)>=0||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=this._listeners.indexOf(e);return!(t<0)&&(this._listeners.splice(t,1),!0)},e.prototype.fire=function(e){this._listeners.forEach((function(t){switch(e.type){case"object:add":t.onObjectAdd&&t.onObjectAdd(e);break;case"object:remove":t.onObjectRemove&&t.onObjectRemove(e)}}))},e}();function n(e,t){var n=t.length-1;return t[n]===e?n:t.indexOf(e)}
/*!
   * Copyright (c) 2020 Arch Inc. (Jun Kato)
   *
   * fabricjs-layer, lightweight layer management for Fabric.js
   * @license MIT
   */"undefined"==typeof fabric?require("fabric").fabric:fabric;var r=function(){function e(e){this.canvas=e,this._activeLayer=new t(e),this._layers=[this._activeLayer],this.onObjectAdd=this.onObjectAdd.bind(this),this.onObjectRemove=this.onObjectRemove.bind(this),e.on("object:added",this.onObjectAdd),e.on("object:removed",this.onObjectRemove)}return Object.defineProperty(e.prototype,"activeLayer",{get:function(){return this._activeLayer},set:function(e){var t=n(e,this._layers);if(t<0)throw new Error("Layer not found or managed");this._activeLayerIndex=t,this._activeLayer=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeLayerIndex",{get:function(){return this._activeLayerIndex},set:function(e){if(e<0||e>=this._layers.length)throw new Error("Layer index out of bounds");this._activeLayerIndex=e,this._activeLayer=this._layers[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layers",{get:function(){return this._layers.slice()},set:function(e){throw new Error("Layers property cannot be set directly.")},enumerable:!0,configurable:!0}),e.prototype.onObjectAdd=function(e){var t=e.target,r=n(t,this.canvas._objects);console.log("added",t,"index",r)},e.prototype.onObjectRemove=function(e){var t=e.target;console.log("removed",t)},e.prototype.addListener=function(e){this._listeners.indexOf(e)>=0||this._listeners.push(e)},e.prototype.removeListener=function(e){var t=this._listeners.indexOf(e);return!(t<0)&&(this._listeners.splice(t,1),!0)},e.prototype.fire=function(e){this._listeners.forEach((function(t){switch(e.type){case"layer:add":t.onLayerAdd&&t.onLayerAdd(e);break;case"layer:remove":t.onLayerRemove&&t.onLayerRemove(e);break;case"layer:move":t.onLayerMove&&t.onLayerMove(e)}}))},e.prototype.dispose=function(){this.canvas.off("object:added",this.onObjectAdd),this.canvas.off("object:removed",this.onObjectRemove),this.canvas=null},e}();e.LayerGroup=t,e.LayerManager=r,e.getIndexOf=n,e.isLayerGroup=function(e){return e&&"Layer"===e.type},Object.defineProperty(e,"__esModule",{value:!0})}));
